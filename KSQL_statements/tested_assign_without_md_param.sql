SELECT 
ASSIGN_LING('low:TR_F;20;30;40;50/normal:TR_F;40;50;60;70/high:TR_F;50;80;90;100', w.TRACTION), COUNT(*) 
FROM AGV_1_STREAM_old w WINDOW TUMBLING (SIZE 24 HOUR) 
GROUP BY 
ASSIGN_LING('low:TR_F;20;30;40;50/normal:TR_F;40;50;60;70/high:TR_F;50;80;90;100', w.TRACTION)
EMIT CHANGES;

SELECT 
ASSIGN_LING('low:TR_F;500;1500;2000;2500/normal:TR_F;2100;2400;3000;3500/high:TR_F;3900;4200;4500;5000', a.CumulativeEnergyConsumption1), 
a.CumulativeEnergyConsumption1 FROM NEW_AGV_1_STREAM a EMIT CHANGES


SELECT 
a.CumulativeEnergyConsumption1,
b.CumulativeEnergyConsumption1,
ASSIGN_LING('low:TR_F;500;1500;2000;2500/normal:TR_F;2100;2400;3000;3500/high:TR_F;3900;4200;4500;5000', a.CumulativeEnergyConsumption1),
ASSIGN_LING('low:TR_F;500;1500;2000;2500/normal:TR_F;2100;2400;3000;3500/high:TR_F;3900;4200;4500;5000', b.CumulativeEnergyConsumption1)
FROM NEW_AGV_1_STREAM a 
INNER JOIN NEW_AGV_2_STREAM b 
WITHIN 7 DAYS 
ON 
ASSIGN_LING('low:TR_F;500;1500;2000;2500/normal:TR_F;2100;2400;3000;3500/high:TR_F;3900;4200;4500;5000', a.CumulativeEnergyConsumption1) = ASSIGN_LING('low:TR_F;500;1500;2000;2500/normal:TR_F;2100;2400;3000;3500/high:TR_F;3900;4200;4500;5000', b.CumulativeEnergyConsumption1)
EMIT CHANGES;
